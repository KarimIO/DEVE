(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){e.exports=a(21)},19:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(9),i=a.n(r),o=a(2),l=a(3),c=a(5),u=a(4),m=a(6),h=a(7),d=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=0===this.props.gallery.length;return s.a.createElement("section",{className:"main-section".concat(this.props.loading?" loading":"").concat(t?" empty":"")},s.a.createElement("div",{className:"gallery"},this.props.gallery.map(function(t,a){return s.a.createElement("div",{key:a,style:{backgroundImage:"url(data:image/jpeg;base64,"+t.thumb+")"}},s.a.createElement("div",null,s.a.createElement("span",null,s.a.createElement("i",null,t.views)," view",1!==t.views&&"s",s.a.createElement("button",{onClick:function(a){return e.props.showImageView(t.id)}},"Show"))))})))}}]),t}(n.Component),g=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=0===this.props.gallery.length;return s.a.createElement("section",{className:"main-section".concat(this.props.loading?" loading":"").concat(e?" empty":"")},s.a.createElement("div",{className:"gallery"},this.props.gallery.map(function(e,t){return s.a.createElement("div",{key:t,style:{backgroundImage:"url(data:image/jpeg;base64,"+e.thumb+")"}},s.a.createElement("div",null,s.a.createElement("span",null,e.views>0&&s.a.createElement("i",null,e.views," view",1!==e.views&&"s"," left"),0===e.views&&s.a.createElement("button",null,"Request"),e.views>0&&s.a.createElement("button",null,"Request More"))))})))}}]),t}(n.Component),p=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=0===this.props.gallery.length;return s.a.createElement("section",{className:"main-section".concat(this.props.loading?" loading":"").concat(e?" empty":"")},s.a.createElement("div",{className:"gallery"},this.props.gallery.map(function(e,t){return s.a.createElement("div",{key:t,style:{backgroundImage:"url(/img/"+e.url+")"}},s.a.createElement("div",null,s.a.createElement("span",null,s.a.createElement("i",null,e.views)," view",1!==e.views&&"s"," left")))})))}}]),t}(n.Component),f=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=0===this.props.requests.length,t=0===this.props.ongoing.length;return s.a.createElement("section",{className:"main-section".concat(this.props.loading?" loading":"")},s.a.createElement("h2",null,"Pending Requests",e&&s.a.createElement("i",null," (None Found)")),s.a.createElement("div",{className:"gallery"},this.props.requests.map(function(e,t){return s.a.createElement("div",{key:t,style:{backgroundImage:"url(/img/"+e.url+")"}},s.a.createElement("div",null,s.a.createElement("span",null,s.a.createElement("b",null,e.user),s.a.createElement("i",null,e.views," view",1!==e.views&&"s"," requested"),s.a.createElement("button",null,"Grant Views"))))})),s.a.createElement("h2",null,"Ongoing Requests",t&&s.a.createElement("i",null," (None Found)")),s.a.createElement("div",{className:"gallery"},this.props.ongoing.map(function(e,t){return s.a.createElement("div",{key:t,style:{backgroundImage:"url(/img/"+e.url+")"}},s.a.createElement("div",null,s.a.createElement("span",null,s.a.createElement("b",null,e.user),s.a.createElement("i",null,e.views," view",1!==e.views&&"s"," left"),s.a.createElement("button",null,"Grant More"))))})))}}]),t}(n.Component),v=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.onChange;return s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{type:this.props.type,placeholder:this.props.placeholder,onChange:e||null}),s.a.createElement("label",null,this.props.label))}}]),t}(n.Component),w=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleShow=function(e){e.preventDefault(),a.setState({show:!a.state.show})},a.state={show:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.value,t=this.props.onChange;return s.a.createElement("div",{className:"input-group password"},s.a.createElement("input",{type:this.state.show?"text":"password",placeholder:this.props.placeholder,value:e||void 0,onChange:t||null}),s.a.createElement("label",null,this.props.label),s.a.createElement("div",{className:"eye".concat(this.state.show?"":" hide"),onClick:this.toggleShow},"Show"))}}]),t}(n.Component),_=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSignUpUsername=function(e){a.setState({r_username:e.target.value})},a.handleSignUpFullname=function(e){a.setState({r_fullname:e.target.value})},a.handleSignUpPassword=function(e){a.setState({r_password:e.target.value})},a.handleSignInUsername=function(e){a.setState({s_username:e.target.value})},a.handleSignInPassword=function(e){a.setState({s_password:e.target.value})},a.setSignState=function(e){a.setState({show_register:e})},a.hide=function(){a.setState({processing:!1,display:!1})},a.handleSignIn=function(e){if(e.preventDefault(),a.setState({processing:!0}),""!==a.state.s_username&&""!==a.state.s_password){var t=a.state.s_username+";"+a.state.s_password;fetch(a.props.domain+"signin",{method:"POST",body:t}).then(function(e){if(e.status>=300)throw"Invalid";return e.text()}).then(function(e){console.log(e),a.setState({processing:!1,r_error:!1}),a.props.setUserInfo({username:a.state.s_username}),a.hide()}).catch(function(e){console.log(e),a.setState({processing:!1,r_error:!0})})}else a.setState({processing:!1,r_error:!0})},a.handleSignUp=function(e){if(e.preventDefault(),a.setState({processing:!0}),""!==a.state.r_username&&""!==a.state.r_password){var t=a.state.r_username+";"+a.state.r_password;fetch(a.props.domain+"signup",{method:"POST",body:t}).then(function(e){if(e.status>=300)throw"Invalid";return e.text()}).then(function(e){console.log(e),a.setState({processing:!1,r_error:!1}),a.props.setUserInfo({username:a.state.r_username}),a.hide()}).catch(function(e){console.log(e),a.setState({processing:!1,r_error:!0})})}else a.setState({processing:!1,r_error:!0})},a.logOut=function(){a.setState({r_fullname:"",r_username:"",r_password:"",s_username:"",s_password:"",display:!0})},a.state={display:!0,r_username:"",r_fullname:"",r_password:"",s_username:"",s_password:"",show_register:!1,processing:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;fetch(this.props.domain+"checkAuth").then(function(e){if(e.status>=300)throw"Invalid";return e.text()}).then(function(t){"__DEVE_INIT"!==t&&(e.props.setUserInfo({username:t}),e.hide())}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this;return s.a.createElement("section",{className:"credentials".concat(this.state.display?"":" hide")},s.a.createElement("div",{className:"side"}),s.a.createElement("div",{className:"main"},s.a.createElement("fieldset",{disabled:this.state.processing},s.a.createElement("div",{className:"credentials-container".concat(this.state.show_register?" hide":"")},s.a.createElement("form",{onSubmit:this.handleSignUp},s.a.createElement("h1",null,"Sign up with ",s.a.createElement("span",null,s.a.createElement("span",null,"D"),"EVE")),s.a.createElement("div",{className:"tagline"},"Have an account? ",s.a.createElement("span",{onClick:function(){return e.setSignState(!0)}},"Sign In")),s.a.createElement(v,{label:"Username",placeholder:"Username",value:this.state.r_username,onChange:this.handleSignUpUsername,type:"text"}),s.a.createElement(w,{label:"Password",placeholder:"Password",value:this.state.r_password,onChange:this.handleSignUpPassword,type:"password"}),s.a.createElement("input",{type:"submit",value:"Sign In"}))),s.a.createElement("div",{className:"credentials-container".concat(this.state.show_register?"":" hide")},s.a.createElement("form",{onSubmit:this.handleSignIn},s.a.createElement("h1",null,"Sign in to ",s.a.createElement("span",null,s.a.createElement("span",null,"D"),"EVE")),s.a.createElement("div",{className:"tagline"},"Don't have an account? ",s.a.createElement("span",{onClick:function(){return e.setSignState(!1)}},"Sign Up")),s.a.createElement(v,{label:"Username",placeholder:"Username",value:this.state.s_username,onChange:this.handleSignInUsername,type:"text"}),s.a.createElement(w,{label:"Password",placeholder:"Password",value:this.state.s_password,onChange:this.handleSignInPassword,type:"password"}),s.a.createElement("input",{type:"submit",value:"Sign In"}))))))}}]),t}(n.Component),E=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getList=function(){return Object.keys(a.props.list).map(function(e,t){return s.a.createElement("div",{className:a.props.sel===e?"selected":"",onClick:function(){return a.props.setUser(e)},key:t},e)})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=0===this.props.list.length;return s.a.createElement("aside",null,s.a.createElement("div",{className:"logo"}),s.a.createElement("div",{className:"main-section user-container".concat(this.props.loading?" loading":"").concat(e?" empty":"")},s.a.createElement("span",{className:"badge"},"Welcome, ",this.props.name),this.getList()))}}]),t}(n.Component),b=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"image-view".concat(this.props.shown?"":" hide"),style:{backgroundImage:"url(data:image/png;base64,"+this.props.image+")"}},s.a.createElement("div",{className:"close",onClick:this.props.hideImageView}))}}]),t}(n.Component),y=a(11),S=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).consume=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"readable"===e.state;){var n=e.read();t+=n.byteLength,console.log("received "+n.byteLength+" bytes ("+t+" bytes in total).")}return"waiting"===e.state&&e.ready.then(function(){return a.consume(e,t)}),e.closed},a.handleDrop=function(e,t){console.log("Accepted",e),console.log("Rejected",t);var n=Object(h.a)(Object(h.a)(a)),s=["image/jpeg","image/png"],r=e.length,i=0,o=a.state.files;e.forEach(function(e){var t=e.type;if(++i,s.includes(t)){var a=new FileReader;a.onload=function(e){var t=e.target.result;o.push(t);var a=document.getElementById("myCanvas"),s=a.getContext("2d"),l=new Image;l.onload=function(){var e=this,r=Math.min(l.width,l.height);s.drawImage(l,0,0,r,r,0,0,a.width,a.height);var i=a.toDataURL("image/jpeg"),o=t.indexOf(",");t=t.substr(o+1),o=i.indexOf(","),i=i.substr(o+1);var c=t+";"+i;fetch(n.props.domain+"image",{method:"POST",body:c}).then(function(e){if(e.status>=300)throw"Invalid";return e.text()}).then(function(e){console.log(e)}).catch(function(t){console.log(t),e.setState({processing:!1,r_error:!0})})},l.src=t,i===r&&n.setState({files:o})},a.onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.readAsDataURL(e)}})},a.state={files:[]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"image-upload".concat(this.props.shown?"":" hide")},s.a.createElement("canvas",{id:"myCanvas"}),s.a.createElement("div",{className:"close",onClick:this.props.hideImageUpload}),s.a.createElement(y.a,{className:"uploadfield",onDrop:this.handleDrop},0===this.state.files.length&&s.a.createElement("div",{id:"middle"},"Drag and Drop files here, or click the area, to upload."),this.state.files.length>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"msg"},"Drag and Drop files here, or click the area, to upload."),s.a.createElement("div",{className:"gallery"},this.state.files.map(function(e,t){return s.a.createElement("div",{key:t,style:{backgroundImage:"url("+e+")"}})})))))}}]),t}(n.Component),O=(a(19),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).domain="http://localhost:22000/",a.fetchMyImages=function(){fetch(a.domain+"/images/"+a.state.user.username).then(function(e){return e.json()}).then(function(e){a.setState({my_images_loading:!1,my_images:e})})},a.fetchOtherImages=function(){fetch(a.domain+"/images/"+a.state.seluser).then(function(e){return e.json()}).then(function(e){a.setState({other_images_error:!1,other_images_loading:!1,other_images:e})}).catch(function(e){console.log(e),a.setState({other_images_error:!0,other_images_loading:!1})})},a.fetchDownloadedImages=function(){fetch("/server/downloaded.json").then(function(e){return e.json()}).then(function(e){a.setState({downloaded_images_error:!1,download_images_loading:!1,download_images:e})}).catch(function(e){console.log(e),a.setState({downloaded_images_error:!0,download_images_loading:!1})})},a.fetchUserList=function(){fetch(a.domain+"userlist").then(function(e){return e.json()}).then(function(e){a.setState({user_list_error:!1,user_list_loading:!1,user_list:e||[]})}).catch(function(e){console.log(e),a.setState({user_list_error:!0,user_list_loading:!1})})},a.fetchRequests=function(){fetch("/server/requests.json").then(function(e){return e.json()}).then(function(e){a.setState({req_error:!1,req_loading:!1,req_list:e.requests,ongoing_list:e.ongoing})}).catch(function(e){console.log(e),a.setState({req_error:!0,req_loading:!1})})},a.setUser=function(e){a.state.seluser!==e?(a.setState({selscreen:0,seluser:e}),a.setState({other_images_loading:!0}),setTimeout(a.fetchOtherImages,1e3)):a.setState({selscreen:0})},a.setScreen=function(e){a.setState({selscreen:e})},a.setUserInfo=function(e){console.log("Logged in as: ",e),a.setState({user:e}),setTimeout(a.fetchMyImages,1e3),setTimeout(a.fetchDownloadedImages,1e3),setTimeout(a.fetchUserList,400),setTimeout(a.fetchRequests,500)},a.handleLogOut=function(){a.credentials.logOut()},a.showImageView=function(e){var t=Object(h.a)(Object(h.a)(a));fetch(a.domain+"image/"+e.ownerID+"/"+e.id+"/"+e.unixTimestamp).then(function(e){return e.text()}).then(function(e){console.log(e),t.setState({show_full_img:!0,full_img:e})}).then(function(e){}).catch(function(e){console.log(e)})},a.hideImageView=function(){a.setState({show_full_img:!1})},a.showImageUpload=function(){a.setState({show_upload:!0})},a.hideImageUpload=function(){a.setState({show_upload:!1})},a.state={user:{username:"",name:""},selscreen:1,my_images:[],my_images_loading:!0,download_images:[],download_images_loading:!0,other_images:[],other_images_loading:!0,user_list:[],user_list_loading:!0,req_list:[],req_loading:!0,ongoing_list:[],ongoing_loading:!0,show_upload:!1,show_full_img:!1,full_img:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state.selscreen,a=this.state.req_list.length,n=a>0;return s.a.createElement("div",{className:"App"},s.a.createElement(E,{name:this.state.user.username,sel:0===this.state.selscreen?this.state.seluser:"",setUser:this.setUser,loading:this.state.user_list_loading,list:this.state.user_list}),s.a.createElement(_,{ref:function(t){e.credentials=t},domain:this.domain,setUserInfo:this.setUserInfo}),s.a.createElement(S,{shown:this.state.show_upload,hideImageUpload:this.hideImageUpload,domain:this.domain}),s.a.createElement(b,{image:this.state.full_img,shown:this.state.show_full_img,hideImageView:this.hideImageView}),s.a.createElement("main",null,s.a.createElement("nav",null,s.a.createElement("span",{className:1===t?"selected":"",onClick:function(){return e.setScreen(1)}},"My Images"),s.a.createElement("span",{className:2===t?"selected":"",onClick:function(){return e.setScreen(2)}},"Downloaded Images"),s.a.createElement("span",{className:"".concat(n?"request-tab":"").concat(3===t?" selected":""),onClick:function(){return e.setScreen(3)}},"Requests ",n&&s.a.createElement("div",{className:"notification"},a)),s.a.createElement("span",{className:"signout-btn",onClick:this.handleLogOut},"Sign Out"),s.a.createElement("span",{className:"add-btn",onClick:this.showImageUpload})),0===t&&s.a.createElement(g,{showImageView:this.showImageView,loading:this.state.other_images_loading,gallery:this.state.other_images}),1===t&&s.a.createElement(d,{showImageView:this.showImageView,loading:this.state.my_images_loading,gallery:this.state.my_images}),2===t&&s.a.createElement(p,{showImageView:this.showImageView,loading:this.state.download_images_loading,gallery:this.state.download_images}),3===t&&s.a.createElement(f,{showImageView:this.showImageView,loading:this.state.req_loading,ongoing:this.state.ongoing_list,requests:this.state.req_list})))}}]),t}(n.Component));i.a.render(s.a.createElement(O,null),document.getElementById("root"))}},[[12,2,1]]]);
//# sourceMappingURL=main.f6d8d815.chunk.js.map